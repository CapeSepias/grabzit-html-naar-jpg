function GrabzIt(e){return new function(e){this.key=e,this.data=null,this.dataKey=null,this.options=null,this.post=!1,this.elem=null,this.protocol=null,this.ConvertURL=function(e,t){return this.data=e,this.dataKey="url",this.options=this._cleanOptions(t),this.post=!1,this},this.ConvertHTML=function(e,t){return this.data=encodeURIComponent(e),this.dataKey="html",this.options=this._cleanOptions(t),this.post=!0,this},this.UseSSL=function(){return this.protocol="https://",this},this._cleanOptions=function(e){if(null==e)return{};var t={};for(var r in e)null!=r&&(t[r.toLowerCase()]=e[r]);return t},this._createXHTTP=function(){return window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},this._post=function(e){var t=this._createXHTTP(),r=this;t.onreadystatechange=function(){4==this.readyState&&200==this.status&&r.elem.appendChild(r._handlePost(JSON.parse(this.responseText)))},t.open("POST",this._getBaseWebServiceUrl(),!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.send(e)},this._getRootURL=function(){return null==this.protocol&&(this.protocol="//","https:"!=window.location.protocol&&"http:"!=window.location.protocol&&(this.protocol="http://")),this.protocol+"api.grabz.it/services/"},this._getBaseWebServiceUrl=function(){return this._getRootURL()+"javascript.ashx"},this._createQueryString=function(e,t){var r="key="+encodeURIComponent(this.key)+"&"+e+"="+encodeURIComponent(t);for(var o in this.options){if("format"!=o&&"cache"!=o&&"customwatermarkid"!=o&&"quality"!=o&&"country"!=o&&"filename"!=o&&"errorid"!=o&&"errorclass"!=o&&"onfinish"!=o&&"onerror"!=o&&"delay"!=o&&"bwidth"!=o&&"bheight"!=o&&"height"!=o&&"width"!=o&&"target"!=o&&"requestas"!=o&&"download"!=o&&"suppresserrors"!=o&&"displayid"!=o&&"displayclass"!=o&&"background"!=o&&"pagesize"!=o&&"orientation"!=o&&"includelinks"!=o&&"includeoutline"!=o&&"title"!=o&&"coverurl"!=o&&"mtop"!=o&&"mleft"!=o&&"mbottom"!=o&&"mright"!=o&&"tabletoinclude"!=o&&"includeheadernames"!=o&&"includealltables"!=o&&"start"!=o&&"duration"!=o&&"speed"!=o&&"fps"!=o&&"repeat"!=o&&"reverse"!=o&&"templateid"!=o&&"noresult"!=o&&"hide"!=o&&"includeimages"!=o&&"export"!=o&&"waitfor"!=o)throw"Option "+o+" not recognized!";var i=this.options[o];null!=i&&(r+="&"+o+"="+encodeURIComponent(i))}return r},this._createScriptNode=function(e){var t=document.createElement("script");return t.src=e,t},this._handlePost=function(e){if(null!=e){if(null==e.ID||""==e.ID)throw e.Message;return this._createScriptNode(this._getBaseWebServiceUrl()+"?"+this._createQueryString("id",e.ID))}},this.DataURI=function(e){var t=null;null!=this.options.onfinish&&(t=this.options.onfinish);var r="grabzItCallback"+Math.floor(Math.random()*(1e9+1));this.options.onfinish=r,this.options.noresult=1;var o=this;window[r]=function(r){var i=o._createXHTTP();i.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var o=new FileReader;o.onload=function(o){null!=e&&e(o.target.result),null!=t&&new Function(t+"('"+r+"')")()},o.readAsDataURL(this.response)}},i.open("GET",o._getRootURL()+"getjspicture.ashx?id="+r,!0),i.responseType="blob",i.send()},this.Create()},this.Create=function(){var e=document.documentElement;null!=document.body&&(e=document.body),this.AddTo(e)},this.AddTo=function(e){if("string"==typeof e||e instanceof String){if(this.elem=document.getElementById(e),null==this.elem)throw"An element with the id "+e+" was not found"}else 1===e.nodeType&&(this.elem=e);if(null==this.elem)throw"No valid element was provided to attach the capture to";"1"!=this.options.download&&delete this.options.download,this.post?this._post(this._createQueryString(this.dataKey,this.data)):this.elem.appendChild(this._createScriptNode(this._getBaseWebServiceUrl()+"?"+this._createQueryString(this.dataKey,this.data)))}}(e)}function GrabzItWebRecorder(){this.timeoutIds=new Array,this.intervalIds=new Array,this.targetId="",this.record=function(e){this.targetId=e},this.freeze=function(){for(var e=0;e<this.timeoutIds.length;e++)clearTimeout(this.timeoutIds[e]);for(var t=0;t<this.intervalIds.length;t++)clearInterval(this.intervalIds[t]);throw new Error("Frozen")},this.setTimeoutId=function(e){this.timeoutIds.push(e)},this.setIntervalId=function(e){this.intervalIds.push(e)},this.load=function(){null!=this.targetId&&""!=this.targetId||alert("Please use the record() method to specify a target element to record.");var e=this.getQueryStringValue();if(""!=e){var t=GrabzItLZString.decompressFromBase64(e),r=document.getElementById(this.targetId);if(null==r)return alert("The target element can not be found."),"";r.innerHTML=t,this.freeze()}},this.AppendURL=function(e){null==e&&(e=location.href);var t=this.getState();return-1==e.indexOf("?")?e+="?":e+="&",e+"grabzit="+t},this.AddTo=function(e,t,r){GrabzIt(e).ConvertURL(this.AppendURL(),r).AddTo(t)},this.Create=function(e,t){return GrabzIt(e).Create(this.AppendURL(),t)},this.getQueryStringValue=function(){return unescape(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+escape("grabzit").replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))},this.isRecording=function(){return""!=this.getQueryStringValue()},this.getState=function(){var e=document.getElementById(this.targetId);if(null==e)return alert("The target element can not be found."),"";this.formatNode(e);var t=e.cloneNode(!0);this.minifyNode(t);var r=t.innerHTML.replace(/\>(\r\n|\n|\r)/gm,">"),o=GrabzItLZString.compressToBase64(r);return o.length>2048?(alert("The size of the web data you are trying to send to GrabzIt is too large. Try to reduce this by specifiying a id of a element that more tightly wraps the data you are interested in recording."),""):o},this.minifyNode=function(e){if(void 0!==e){if(e.tagName&&"a"==e.tagName.toLowerCase()){var t=e.getAttribute("href");null!=t&&""!=t&&e.setAttribute("href","#")}if(e.tagName&&"img"==e.tagName.toLowerCase()){var r=e.getAttribute("src");null!=r&&e.setAttribute("src",r.replace(/^(https?):\/\//,"//"))}if(1==e.nodeType){var o=e.getAttribute("value");if(null!=o&&""!=o&&(null==e.tagName||"input"!=e.tagName.toLowerCase()||null==e.getAttribute("type")||"checkbox"!=e.getAttribute("type").toLowerCase()&&"radio"!=e.getAttribute("type").toLowerCase())||e.removeAttribute("value"),null!=e.tagName&&"select"==e.tagName.toLowerCase())for(i=0;i<e.childNodes.length;i++)e.childNodes[i].tagName&&null==e.childNodes[i].getAttribute("selected")&&e.removeChild(e.childNodes[i]),e.childNodes[i].tagName&&"option"==e.childNodes[i].tagName.toLowerCase()&&e.childNodes[i].removeAttribute("selected");e.removeAttribute("alt"),e.removeAttribute("title"),e.removeAttribute("onclick"),e.removeAttribute("onchange"),e.removeAttribute("onload"),e.removeAttribute("onafterprint"),e.removeAttribute("onbeforeprint"),e.removeAttribute("onbeforeunload"),e.removeAttribute("onerror"),e.removeAttribute("onhashchange"),e.removeAttribute("onmessage"),e.removeAttribute("onoffline"),e.removeAttribute("online"),e.removeAttribute("onpagehide"),e.removeAttribute("onpageshow"),e.removeAttribute("onpopstate"),e.removeAttribute("onresize"),e.removeAttribute("onstorage"),e.removeAttribute("onunload"),e.removeAttribute("onblur"),e.removeAttribute("oncontextmenu"),e.removeAttribute("onfocus"),e.removeAttribute("oninput"),e.removeAttribute("oninvalid"),e.removeAttribute("onreset"),e.removeAttribute("onsearch"),e.removeAttribute("onselect"),e.removeAttribute("onkeydown"),e.removeAttribute("onkeypress"),e.removeAttribute("onkeyup"),e.removeAttribute("ondblclick"),e.removeAttribute("ondrag"),e.removeAttribute("ondragend"),e.removeAttribute("ondragenter"),e.removeAttribute("ondragstart"),e.removeAttribute("ondrop"),e.removeAttribute("onmousedown"),e.removeAttribute("onmousemove"),e.removeAttribute("onmouseout"),e.removeAttribute("onmouseover"),e.removeAttribute("onmouseup"),e.removeAttribute("onmousewheel"),e.removeAttribute("onscroll"),e.removeAttribute("onwheel")}for(var i=0;i<e.childNodes.length;i++)this.minifyNode(e.childNodes[i])}},this.formatNode=function(e){if(void 0!==e){if(null!=e.value)if(e.tagName&&"textarea"==e.tagName.toLowerCase())e.innerHTML=e.value;else if(e.tagName&&"select"==e.tagName.toLowerCase())for(t=0;t<e.childNodes.length;t++)e.childNodes[t].tagName&&"option"==e.childNodes[t].tagName.toLowerCase()&&(e.childNodes[t].removeAttribute("selected"),e.childNodes[t].value==e.value&&e.childNodes[t].setAttribute("selected","selected"));else null!=e.value&&""!=e.value&&e.setAttribute("value",e.value);e.checked?e.setAttribute("checked","checked"):e.tagName&&"input"==e.tagName.toLowerCase()&&e.removeAttribute("checked");for(var t=0;t<e.childNodes.length;t++)this.formatNode(e.childNodes[t])}};!function(e){var t=window.onload;window.onload=function(){e.load(),null!=t&&t()}}(this)}var GrabzItLZString={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(e){if(null==e)return"";var t,r,o,i,n,a,s,l="",c=0;for(e=GrabzItLZString.compress(e);c<2*e.length;)c%2==0?(t=e.charCodeAt(c/2)>>8,r=255&e.charCodeAt(c/2),o=c/2+1<e.length?e.charCodeAt(c/2+1)>>8:NaN):(t=255&e.charCodeAt((c-1)/2),(c+1)/2<e.length?(r=e.charCodeAt((c+1)/2)>>8,o=255&e.charCodeAt((c+1)/2)):r=o=NaN),c+=3,i=t>>2,n=(3&t)<<4|r>>4,a=(15&r)<<2|o>>6,s=63&o,isNaN(r)?a=s=64:isNaN(o)&&(s=64),l=l+GrabzItLZString._keyStr.charAt(i)+GrabzItLZString._keyStr.charAt(n)+GrabzItLZString._keyStr.charAt(a)+GrabzItLZString._keyStr.charAt(s);return l},decompressFromBase64:function(e){if(null==e)return"";var t,r,o,i,n,a,s,l="",c=0,u=0,h=GrabzItLZString._f;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<e.length;)r=GrabzItLZString._keyStr.indexOf(e.charAt(u++))<<2|(n=GrabzItLZString._keyStr.indexOf(e.charAt(u++)))>>4,o=(15&n)<<4|(a=GrabzItLZString._keyStr.indexOf(e.charAt(u++)))>>2,i=(3&a)<<6|(s=GrabzItLZString._keyStr.indexOf(e.charAt(u++))),c%2==0?(t=r<<8,64!=a&&(l+=h(t|o)),64!=s&&(t=i<<8)):(l+=h(t|r),64!=a&&(t=o<<8),64!=s&&(l+=h(t|i))),c+=3;return GrabzItLZString.decompress(l)},compressToUTF16:function(e){if(null==e)return"";var t,r,o,i="",n=0,a=GrabzItLZString._f;for(e=GrabzItLZString.compress(e),t=0;t<e.length;t++)switch(r=e.charCodeAt(t),n++){case 0:i+=a(32+(r>>1)),o=(1&r)<<14;break;case 1:i+=a(o+(r>>2)+32),o=(3&r)<<13;break;case 2:i+=a(o+(r>>3)+32),o=(7&r)<<12;break;case 3:i+=a(o+(r>>4)+32),o=(15&r)<<11;break;case 4:i+=a(o+(r>>5)+32),o=(31&r)<<10;break;case 5:i+=a(o+(r>>6)+32),o=(63&r)<<9;break;case 6:i+=a(o+(r>>7)+32),o=(127&r)<<8;break;case 7:i+=a(o+(r>>8)+32),o=(255&r)<<7;break;case 8:i+=a(o+(r>>9)+32),o=(511&r)<<6;break;case 9:i+=a(o+(r>>10)+32),o=(1023&r)<<5;break;case 10:i+=a(o+(r>>11)+32),o=(2047&r)<<4;break;case 11:i+=a(o+(r>>12)+32),o=(4095&r)<<3;break;case 12:i+=a(o+(r>>13)+32),o=(8191&r)<<2;break;case 13:i+=a(o+(r>>14)+32),o=(16383&r)<<1;break;case 14:i+=a(o+(r>>15)+32,32+(32767&r)),n=0}return i+a(o+32)},decompressFromUTF16:function(e){if(null==e)return"";for(var t,r,o="",i=0,n=0,a=GrabzItLZString._f;n<e.length;){switch(r=e.charCodeAt(n)-32,i++){case 0:t=r<<1;break;case 1:o+=a(t|r>>14),t=(16383&r)<<2;break;case 2:o+=a(t|r>>13),t=(8191&r)<<3;break;case 3:o+=a(t|r>>12),t=(4095&r)<<4;break;case 4:o+=a(t|r>>11),t=(2047&r)<<5;break;case 5:o+=a(t|r>>10),t=(1023&r)<<6;break;case 6:o+=a(t|r>>9),t=(511&r)<<7;break;case 7:o+=a(t|r>>8),t=(255&r)<<8;break;case 8:o+=a(t|r>>7),t=(127&r)<<9;break;case 9:o+=a(t|r>>6),t=(63&r)<<10;break;case 10:o+=a(t|r>>5),t=(31&r)<<11;break;case 11:o+=a(t|r>>4),t=(15&r)<<12;break;case 12:o+=a(t|r>>3),t=(7&r)<<13;break;case 13:o+=a(t|r>>2),t=(3&r)<<14;break;case 14:o+=a(t|r>>1),t=(1&r)<<15;break;case 15:o+=a(t|r),i=0}n++}return GrabzItLZString.decompress(o)},compress:function(e){if(null==e)return"";var t,r,o,i={},n={},a="",s="",l="",c=2,u=3,h=2,d="",p=0,b=0,f=GrabzItLZString._f;for(o=0;o<e.length;o+=1)if(a=e.charAt(o),Object.prototype.hasOwnProperty.call(i,a)||(i[a]=u++,n[a]=!0),s=l+a,Object.prototype.hasOwnProperty.call(i,s))l=s;else{if(Object.prototype.hasOwnProperty.call(n,l)){if(l.charCodeAt(0)<256){for(t=0;t<h;t++)p<<=1,15==b?(b=0,d+=f(p),p=0):b++;for(r=l.charCodeAt(0),t=0;t<8;t++)p=p<<1|1&r,15==b?(b=0,d+=f(p),p=0):b++,r>>=1}else{for(r=1,t=0;t<h;t++)p=p<<1|r,15==b?(b=0,d+=f(p),p=0):b++,r=0;for(r=l.charCodeAt(0),t=0;t<16;t++)p=p<<1|1&r,15==b?(b=0,d+=f(p),p=0):b++,r>>=1}0==--c&&(c=Math.pow(2,h),h++),delete n[l]}else for(r=i[l],t=0;t<h;t++)p=p<<1|1&r,15==b?(b=0,d+=f(p),p=0):b++,r>>=1;0==--c&&(c=Math.pow(2,h),h++),i[s]=u++,l=String(a)}if(""!==l){if(Object.prototype.hasOwnProperty.call(n,l)){if(l.charCodeAt(0)<256){for(t=0;t<h;t++)p<<=1,15==b?(b=0,d+=f(p),p=0):b++;for(r=l.charCodeAt(0),t=0;t<8;t++)p=p<<1|1&r,15==b?(b=0,d+=f(p),p=0):b++,r>>=1}else{for(r=1,t=0;t<h;t++)p=p<<1|r,15==b?(b=0,d+=f(p),p=0):b++,r=0;for(r=l.charCodeAt(0),t=0;t<16;t++)p=p<<1|1&r,15==b?(b=0,d+=f(p),p=0):b++,r>>=1}0==--c&&(c=Math.pow(2,h),h++),delete n[l]}else for(r=i[l],t=0;t<h;t++)p=p<<1|1&r,15==b?(b=0,d+=f(p),p=0):b++,r>>=1;0==--c&&(c=Math.pow(2,h),h++)}for(r=2,t=0;t<h;t++)p=p<<1|1&r,15==b?(b=0,d+=f(p),p=0):b++,r>>=1;for(;;){if(p<<=1,15==b){d+=f(p);break}b++}return d},decompress:function(e){if(null==e)return"";if(""==e)return null;var t,r,o,i,n,a,s,l=[],c=4,u=4,h=3,d="",p="",b=GrabzItLZString._f,f={string:e,val:e.charCodeAt(0),position:32768,index:1};for(t=0;t<3;t+=1)l[t]=t;for(o=0,n=Math.pow(2,2),a=1;a!=n;)i=f.val&f.position,f.position>>=1,0==f.position&&(f.position=32768,f.val=f.string.charCodeAt(f.index++)),o|=(i>0?1:0)*a,a<<=1;switch(o){case 0:for(o=0,n=Math.pow(2,8),a=1;a!=n;)i=f.val&f.position,f.position>>=1,0==f.position&&(f.position=32768,f.val=f.string.charCodeAt(f.index++)),o|=(i>0?1:0)*a,a<<=1;s=b(o);break;case 1:for(o=0,n=Math.pow(2,16),a=1;a!=n;)i=f.val&f.position,f.position>>=1,0==f.position&&(f.position=32768,f.val=f.string.charCodeAt(f.index++)),o|=(i>0?1:0)*a,a<<=1;s=b(o);break;case 2:return""}for(l[3]=s,r=p=s;;){if(f.index>f.string.length)return"";for(o=0,n=Math.pow(2,h),a=1;a!=n;)i=f.val&f.position,f.position>>=1,0==f.position&&(f.position=32768,f.val=f.string.charCodeAt(f.index++)),o|=(i>0?1:0)*a,a<<=1;switch(s=o){case 0:for(o=0,n=Math.pow(2,8),a=1;a!=n;)i=f.val&f.position,f.position>>=1,0==f.position&&(f.position=32768,f.val=f.string.charCodeAt(f.index++)),o|=(i>0?1:0)*a,a<<=1;l[u++]=b(o),s=u-1,c--;break;case 1:for(o=0,n=Math.pow(2,16),a=1;a!=n;)i=f.val&f.position,f.position>>=1,0==f.position&&(f.position=32768,f.val=f.string.charCodeAt(f.index++)),o|=(i>0?1:0)*a,a<<=1;l[u++]=b(o),s=u-1,c--;break;case 2:return p}if(0==c&&(c=Math.pow(2,h),h++),l[s])d=l[s];else{if(s!==u)return null;d=r+r.charAt(0)}p+=d,l[u++]=r+d.charAt(0),r=d,0==--c&&(c=Math.pow(2,h),h++)}}},GrabzItWebRecorder=new GrabzItWebRecorder;window.GrabzItSetTimeout=window.setTimeout,window.setTimeout=function(e,t){var r=window.GrabzItSetTimeout(e,t);return GrabzItWebRecorder.setTimeoutId(r),r},window.GrabzItSetInterval=window.setInterval,window.setInterval=function(e,t){var r=window.GrabzItSetInterval(e,t);return GrabzItWebRecorder.setIntervalId(r),r};